<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ó–∞–ø–∏—Å—å –∫ —Å—Ç–æ–º–∞—Ç–æ–ª–æ–≥—É</title>
    <style>
        /* --- CSS –°–¢–ò–õ–ò --- */
        
        /* –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--tg-theme-bg-color, #ffffff); /* –¶–≤–µ—Ç —Ñ–æ–Ω–∞ –∏–∑ —Ç–µ–º—ã –¢–µ–ª–µ–≥—Ä–∞–º */
            color: var(--tg-theme-text-color, #000000); /* –¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ –∏–∑ —Ç–µ–º—ã */
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }

        h1, h3 { margin-top: 0; }
        
        /* –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ */
        .header {
            text-align: center;
            margin-bottom: 20px;
        }
        .header h1 {
            font-size: 24px;
            margin-bottom: 5px;
        }
        .header p {
            color: var(--tg-theme-hint-color, #888);
            margin: 0;
        }

        /* –°–µ—Ç–∫–∞ –∫–∞—Ä—Ç–æ—á–µ–∫ —É—Å–ª—É–≥ */
        .services-grid {
            display: grid;
            grid-template-columns: 1fr 1fr; /* –î–≤–µ –∫–æ–ª–æ–Ω–∫–∏ */
            gap: 10px;
            margin-bottom: 20px;
        }

        /* –°—Ç–∏–ª—å –æ–¥–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏ */
        .service-card {
            background-color: var(--tg-theme-secondary-bg-color, #f5f5f5);
            border: 2px solid transparent;
            border-radius: 12px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
        }

        .service-card .icon { font-size: 32px; margin-bottom: 10px; display: block; }
        .service-card .title { font-weight: bold; font-size: 14px; display: block; margin-bottom: 5px; }
        .service-card .price { font-size: 12px; opacity: 0.8; }

        /* –°—Ç–∏–ª—å –í–´–ë–†–ê–ù–ù–û–ô –∫–∞—Ä—Ç–æ—á–∫–∏ */
        .service-card.selected {
            border-color: var(--tg-theme-button-color, #2481cc); /* –°–∏–Ω–∏–π —Ü–≤–µ—Ç –¢–µ–ª–µ–≥—Ä–∞–º–∞ */
            background-color: rgba(36, 129, 204, 0.1); /* –õ–µ–≥–∫–∏–π —Å–∏–Ω–∏–π —Ñ–æ–Ω */
        }

        /* –ü–æ–ª—è –≤–≤–æ–¥–∞ */
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: 500; font-size: 14px; }
        
        input, textarea {
            width: 100%;
            padding: 12px;
            box-sizing: border-box;
            border: 1px solid var(--tg-theme-hint-color, #ccc);
            border-radius: 8px;
            background-color: var(--tg-theme-bg-color, #fff);
            color: var(--tg-theme-text-color, #000);
            font-size: 16px;
            outline: none;
        }
        
        input:focus { border-color: var(--tg-theme-button-color, #2481cc); }

        /* –°–∫—Ä—ã–≤–∞–µ–º –±–ª–æ–∫–∏ –æ—à–∏–±–æ–∫ */
        .error { color: #ff3b30; font-size: 12px; display: none; margin-top: 5px; }

    </style>
</head>
<body>

    <!-- 1. –®–ê–ü–ö–ê -->
    <div class="header">
        <h1 id="greeting">–ü—Ä–∏–≤–µ—Ç! üëã</h1>
        <p>–ó–∞–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ –ø—Ä–∏–µ–º –∫ —Å—Ç–æ–º–∞—Ç–æ–ª–æ–≥—É</p>
    </div>

    <!-- 2. –í–´–ë–û–† –£–°–õ–£–ì–ò (–ö–∞—Ä—Ç–æ—á–∫–∏) -->
    <h3>–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É:</h3>
    <div class="services-grid">
        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ 1 -->
        <div class="service-card" onclick="selectService('consultation', 0)">
            <span class="icon">ü©∫</span>
            <span class="title">–û—Å–º–æ—Ç—Ä</span>
            <span class="price">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</span>
        </div>
        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ 2 -->
        <div class="service-card" onclick="selectService('caries', 3000)">
            <span class="icon">ü¶∑</span>
            <span class="title">–õ–µ—á–µ–Ω–∏–µ</span>
            <span class="price">–æ—Ç 3000‚ÇΩ</span>
        </div>
        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ 3 -->
        <div class="service-card" onclick="selectService('cleaning', 5000)">
            <span class="icon">‚ú®</span>
            <span class="title">–ß–∏—Å—Ç–∫–∞</span>
            <span class="price">5000‚ÇΩ</span>
        </div>
        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ 4 -->
        <div class="service-card" onclick="selectService('whitening', 10000)">
            <span class="icon">üíé</span>
            <span class="title">–û—Ç–±–µ–ª–∏–≤–∞–Ω–∏–µ</span>
            <span class="price">10000‚ÇΩ</span>
        </div>
    </div>

    <!-- 3. –î–ê–¢–ê –ò –í–†–ï–ú–Ø -->
    <div class="form-group">
        <label>–î–∞—Ç–∞ –ø—Ä–∏–µ–º–∞:</label>
        <input type="date" id="date-input">
    </div>
    <div class="form-group">
        <label>–í—Ä–µ–º—è:</label>
        <input type="time" id="time-input" min="09:00" max="20:00" step="1800"> <!-- —à–∞–≥ 30 –º–∏–Ω -->
    </div>

    <!-- 4. –ö–û–ù–¢–ê–ö–¢–´ -->
    <div class="form-group">
        <label>–í–∞—à —Ç–µ–ª–µ—Ñ–æ–Ω:</label>
        <input type="tel" id="phone-input" placeholder="+7 (999) 000-00-00">
    </div>
    
    <div class="form-group">
        <label>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):</label>
        <textarea id="comment-input" rows="3" placeholder="–ë–æ–ª–∏—Ç –∑—É–± —Å–ø—Ä–∞–≤–∞..."></textarea>
    </div>

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Telegram Script -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <script>
        // --- –õ–û–ì–ò–ö–ê –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø (JS) ---
        
        let tg = window.Telegram.WebApp;
        tg.expand(); // –†–∞—Å–∫—Ä—ã—Ç—å –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω

        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—ã–±–æ—Ä–∞
        let selectedService = null;
        let selectedPrice = 0;

        // 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (–ø–æ–¥—Å—Ç–∞–≤–ª—è–µ–º –∏–º—è)
        // –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–æ –≤ –¢–µ–ª–µ–≥—Ä–∞–º - –±–µ—Ä–µ–º –∏–º—è, –µ—Å–ª–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ - —Å—Ç–∞–≤–∏–º "–ì–æ—Å—Ç—å"
        let user_name = tg.initDataUnsafe.user ? tg.initDataUnsafe.user.first_name : "–ì–æ—Å—Ç—å";
        document.getElementById("greeting").innerText = `–ü—Ä–∏–≤–µ—Ç, ${user_name}! üëã`;

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ì–ª–∞–≤–Ω–æ–π –ö–Ω–æ–ø–∫–∏
        tg.MainButton.textColor = "#FFFFFF";
        tg.MainButton.color = "#2cab37"; // –ó–µ–ª–µ–Ω—ã–π —Ü–≤–µ—Ç

        // 2. –§—É–Ω–∫—Ü–∏—è –≤—ã–±–æ—Ä–∞ —É—Å–ª—É–≥–∏
        function selectService(serviceName, price) {
            selectedService = serviceName;
            selectedPrice = price;

            // –í–∏–∑—É–∞–ª—å–Ω–æ –≤—ã–¥–µ–ª—è–µ–º –∫–∞—Ä—Ç–æ—á–∫—É
            let cards = document.querySelectorAll('.service-card');
            cards.forEach(card => card.classList.remove('selected')); // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —É –≤—Å–µ—Ö
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Ç–æ–º—É, –Ω–∞ —á—Ç–æ –Ω–∞–∂–∞–ª–∏ (—á–µ—Ä–µ–∑ event)
            event.currentTarget.classList.add('selected');

            checkForm(); // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –º–æ–∂–Ω–æ –ª–∏ –ø–æ–∫–∞–∑–∞—Ç—å –∫–Ω–æ–ø–∫—É
        }

        // 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º—ã (–≤–∞–ª–∏–¥–∞—Ü–∏—è)
        // –°–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø–æ–ª—è—Ö
        document.getElementById('date-input').addEventListener('change', checkForm);
        document.getElementById('time-input').addEventListener('change', checkForm);
        document.getElementById('phone-input').addEventListener('input', checkForm);

        function checkForm() {
            let date = document.getElementById('date-input').value;
            let time = document.getElementById('time-input').value;
            let phone = document.getElementById('phone-input').value;

            // –ï—Å–ª–∏ –≤—Å–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ
            if (selectedService && date && time && phone.length > 5) {
                tg.MainButton.text = `–ó–∞–ø–∏—Å–∞—Ç—å—Å—è (${selectedPrice > 0 ? selectedPrice + '‚ÇΩ' : '–ë–µ—Å–ø–ª–∞—Ç–Ω–æ'})`;
                tg.MainButton.show();
            } else {
                tg.MainButton.hide(); // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É, –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ
            }
        }

        // 4. –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –±–æ—Ç—É
        Telegram.WebApp.onEvent('mainButtonClicked', function(){
            let data = {
                type: 'booking', // –º–µ—Ç–∫–∞, —á—Ç–æ —ç—Ç–æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
                service: selectedService,
                price: selectedPrice,
                date: document.getElementById('date-input').value,
                time: document.getElementById('time-input').value,
                phone: document.getElementById('phone-input').value,
                comment: document.getElementById('comment-input').value,
                user_name: user_name
            };
            
            tg.sendData(JSON.stringify(data));
        });

    </script>
</body>
</html>